<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <title>PG Mtel</title>
    <style>
        body {
            background-color: #1a1a1a;
            color: white;
            font-family: Arial, sans-serif;
            padding: 20px;
            display: flex;
            justify-content: space-between;
        }

        .main-content {
            width: 60%;
        }

        .comment-section {
            width: 35%;
            background-color: #2a2a2a;
            padding: 15px;
            border-radius: 8px;
        }

        .zuto-dugme {
            display: inline-block;
            background-color: yellow;
            color: black;
            padding: 10px 20px;
            text-decoration: none;
            font-weight: bold;
            border-radius: 5px;
            margin-top: 20px;
        }

        .zuto-dugme:hover {
            background-color: #e6d200;
        }

        .comment {
            background-color: #3a3a3a;
            padding: 10px;
            margin-top: 10px;
            border-radius: 5px;
            position: relative;
        }

        .comment button {
            position: absolute;
            right: 10px;
            top: 10px;
            background-color: red;
            color: white;
            border: none;
            padding: 3px 7px;
            cursor: pointer;
            border-radius: 3px;
        }

        textarea, input[type=text] {
            width: 100%;
            resize: none;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
            border: none;
            font-size: 14px;
            box-sizing: border-box;
        }

        .comment-form button {
            width: 100%;
            padding: 10px;
            background-color: yellow;
            color: black;
            font-weight: bold;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .comment-form button:hover {
            background-color: #e6d200;
        }

        #poruka {
            margin-top: 10px;
            min-height: 20px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="main-content">
        <h1>PG Mtel</h1>
        <p>5/1/3 4,7 šum 18dB nod Crnogorskih serdara 81.</p>
        <p>5/1/3 4,7 Šum 21db nod Zeta Gradnja Stadion 4.</p>
        <p>5/1/0 4,7 šum 18db nod Hotel New Star.</p>
        <p>5/1/3 0,3 šum 24db 2 noda Jovana Tomaševića 17 i Bratstva i Jedinstva 175.</p>
        <p>5/1/1 0,3 šum 17dB nod Nikic-stanovi.</p>
        <a href="../index.html" class="zuto-dugme">Nazad na početnu</a>
    </div>

    <div class="comment-section">
        <h2>Komentari</h2>
        <div class="comment-form">
            <input type="text" id="gradInput" placeholder="Unesite ime grada" />
            <textarea id="commentInput" rows="3" placeholder="Unesite komentar..."></textarea>
            <button onclick="addComment()">Pošalji komentar</button>
            <div id="poruka"></div>
        </div>
        <div id="commentsList"></div>
    </div>

    <!-- EmailJS -->
    <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
    <script>
        // Inicijalizuj EmailJS sa tvojim public key-em
        emailjs.init('eQTleYe3eIjJ_s9ok');

        window.onload = function() {
            loadComments();
        };

        function addComment() {
            const grad = document.getElementById('gradInput').value.trim();
            const text = document.getElementById('commentInput').value.trim();
            const porukaDiv = document.getElementById('poruka');

            if (!grad || !text) {
                porukaDiv.style.color = 'red';
                porukaDiv.textContent = 'Molimo popunite oba polja!';
                return;
            }

            porukaDiv.textContent = '';

            // Slanje mejla preko EmailJS
            emailjs.send('service_xjyx9s9', 'template_0xyiz5f', {
                city: grad,
                message: text
            })
            .then(() => {
                porukaDiv.style.color = 'lightgreen';
                porukaDiv.textContent = 'Komentar je uspešno poslat!';
                saveComment(text);
                document.getElementById('gradInput').value = '';
                document.getElementById('commentInput').value = '';
            }, (error) => {
                porukaDiv.style.color = 'red';
                porukaDiv.textContent = 'Greška prilikom slanja!';
                console.error('EmailJS greška:', error);
            });
        }

        function saveComment(text) {
            let comments = JSON.parse(localStorage.getItem('comments')) || [];
            comments.push(text);
            localStorage.setItem('comments', JSON.stringify(comments));
            loadComments();
        }

        function deleteComment(index) {
            let comments = JSON.parse(localStorage.getItem('comments')) || [];
            comments.splice(index, 1);
            localStorage.setItem('comments', JSON.stringify(comments));
            loadComments();
        }

        function loadComments() {
            const container = document.getElementById('commentsList');
            container.innerHTML = "";
            const comments = JSON.parse(localStorage.getItem('comments')) || [];

            comments.forEach((comment, index) => {
                const div = document.createElement('div');
                div.className = 'comment';
                div.innerHTML = `
                    ${comment}
                    <button onclick="deleteComment(${index})">Obriši</button>
                `;
                container.appendChild(div);
            });
        }
    </script>
</body>
</html>
